<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Labirintus érintéssel</title>
<style>
  body { display: flex; justify-content: center; align-items: center; height: 100vh; background: #f0f0f0; }
  #maze { width: 400px; height: 400px; background: #eee; position: relative; border: 5px solid #333; touch-action: none; }
  .wall { position: absolute; background: #333; }
  #ball { width: 20px; height: 20px; background: red; border-radius: 50%; position: absolute; top: 10px; left: 10px; }
  #finish { width: 30px; height: 30px; background: green; position: absolute; top: 350px; left: 350px; }
</style>
</head>
<body>

<div id="maze">
  <!-- Falak -->
  <div class="wall" style="top: 0px; left: 50px; width: 300px; height: 20px;"></div>
  <div class="wall" style="top: 50px; left: 50px; width: 20px; height: 300px;"></div>
  <div class="wall" style="top: 300px; left: 70px; width: 250px; height: 20px;"></div>
  <div class="wall" style="top: 100px; left: 150px; width: 20px; height: 200px;"></div>
  
  <!-- Finish -->
  <div id="finish"></div>
  
  <!-- Labda -->
  <div id="ball"></div>
</div>

<script>
const ball = document.getElementById('ball');
const maze = document.getElementById('maze');
const walls = document.querySelectorAll('.wall');
const finish = document.getElementById('finish');

let offsetX = 0, offsetY = 0;
let dragging = false;

function checkCollision(nx, ny) {
  const ballRect = {left: nx, top: ny, right: nx+20, bottom: ny+20};
  for(let wall of walls) {
    const w = wall.getBoundingClientRect();
    const m = maze.getBoundingClientRect();
    const wallRect = {left: w.left - m.left, top: w.top - m.top, right: w.right - m.left, bottom: w.bottom - m.top};
    if(!(ballRect.right < wallRect.left || ballRect.left > wallRect.right || ballRect.bottom < wallRect.top || ballRect.top > wallRect.bottom)) {
      return true;
    }
  }
  return false;
}

function checkFinish() {
  const b = ball.getBoundingClientRect();
  const f = finish.getBoundingClientRect();
  const m = maze.getBoundingClientRect();
  const ballRect = {left: b.left - m.left, top: b.top - m.top, right: b.right - m.left, bottom: b.bottom - m.top};
  const finishRect = {left: f.left - m.left, top: f.top - m.top, right: f.right - m.left, bottom: f.bottom - m.top};
  if(!(ballRect.right < finishRect.left || ballRect.left > finishRect.right || ballRect.bottom < finishRect.top || ballRect.top > finishRect.bottom)) {
    alert("Gratulálok! Átjutottál a labirintuson!");
    ball.style.top = "10px";
    ball.style.left = "10px";
  }
}

// Érintés események
ball.addEventListener('touchstart', (e) => {
  dragging = true;
  const touch = e.touches[0];
  offsetX = touch.clientX - ball.getBoundingClientRect().left;
  offsetY = touch.clientY - ball.getBoundingClientRect().top;
});

ball.addEventListener('touchmove', (e) => {
  if(!dragging) return;
  e.preventDefault();
  const touch = e.touches[0];
  const m = maze.getBoundingClientRect();
  let nx = touch.clientX - m.left - offsetX;
  let ny = touch.clientY - m.top - offsetY;
  
  if(!checkCollision(nx, ny)) {
    ball.style.left = nx + "px";
    ball.style.top = ny + "px";
    checkFinish();
  }
});

ball.addEventListener('touchend', () => {
  dragging = false;
});
</script>

</body>
</html>
